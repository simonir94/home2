<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page Personalizzata - Fisco</title>
    <style>
        /* --- RESET E BASI --- */
        body { 
            background-color: #f0f2f5; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0;
            padding: 40px 20px;
            display: flex;
            flex-direction: column; 
            align-items: center;    
        }

        /* --- RICERCA --- */
        .search-section {
            width: 100%;
            max-width: 600px;
            margin-bottom: 40px; 
            text-align: center;
        }
        .search-wrapper {
            background: white;
            padding: 8px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
        }
        .search-form { display: flex; width: 100%; align-items: center; }
        .search-input { border: none; outline: none; flex-grow: 1; padding: 10px; font-size: 16px; }
        .search-button { background-color: #4285f4; color: white; border: none; padding: 8px 20px; border-radius: 50px; cursor: pointer; font-weight: bold; }

        /* --- CONTENITORI --- */
        .colonnasiti {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        /* --- MATTONELLE --- */
        .tile {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            transition: all 0.2s;
            padding: 10px;
            box-sizing: border-box;
            flex: 1 1 120px; 
            min-width: 110px;
            max-width: 250px;
        }

        .tile-wide {
            flex: 2 1 240px;
            min-width: 220px;
        }

        .tile:hover { 
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-color: #3b82f6;
        }

        .tile img { 
            max-width: 90%; 
            max-height: 75%; 
            object-fit: contain;
        }

        /* Classi Colore Originali */
        .prima { background-color: rgb(46, 121, 219); }
        .seconda { background-color: rgb(224, 42, 38); }
        .terza { background-color: rgb(153, 204, 96); }

        /* --- SEZIONE NEWS --- */
        .news-container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-top: 10px;
        }
        .news-title-header {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 18px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .news-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .news-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            border-left: 4px solid #4285f4;
            transition: background 0.2s;
        }
        .news-item:hover {
            background: #eef4ff;
        }
        .news-text { font-size: 14px; font-weight: 500; flex-grow: 1; padding-right: 15px; }
        .news-source { font-size: 10px; text-transform: uppercase; color: #4285f4; font-weight: bold; margin-bottom: 2px; display: block; }
        .news-date { font-size: 11px; color: #888; white-space: nowrap; }

        /* Responsive Mobile */
        @media (max-width: 600px) {
            .tile-wide { flex: 1 1 100%; }
            .tile { flex: 1 1 40%; }
        }
    </style>
</head>
<body>

    <div class="search-section">
        <div class="search-wrapper">
            <form action="https://www.google.com/search" method="GET" class="search-form">
                <input type="text" name="q" class="search-input" placeholder="Cerca su Google..." autofocus>
                <button type="submit" class="search-button">Cerca</button>
            </form>
        </div>
    </div>

    <div class="colonnasiti prima">
        <a href="https://secure.bpointsaas.it/" target="_blank" class="tile tile-wide">
            <img src="bpoint.png">
        </a>
        <a href="https://web.whatsapp.com/" target="_blank" class="tile tile-wide">
            <img src="whatsapp.webp">
        </a>
        <a href="https://iampe.agenziaentrate.gov.it/sam/UI/Login?realm=/agenziaentrate" target="_blank" class="tile tile-wide">
            <img src="agenziaentrate.png">
        </a>
        <a href="https://www.agenziaentrateriscossione.gov.it/it/#" target="_self" class="tile">
            <img src="aer.jpg">
        </a>
        <a href="https://www.webdesk.it/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/webdesk.jpg">
        </a>
        <a href="https://codicefiscale.it/inverso/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/cf.png">
        </a>
        <a href="https://www.pec.it/webmail-pec.aspx" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/arubapec.png">
        </a>
        <a href="https://www.rentri.gov.it/it" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/rentri.jpg">
        </a>
    </div>

    <div class="colonnasiti seconda">
        <a href="https://mail.google.com/mail/u/0/#inbox" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/gmail.webp">
        </a>
        <a href="https://gemini.google.com/app" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/gemini.png">
        </a>
        <a href="https://drive.google.com/drive/u/0/my-drive" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/drive.png">
        </a>
        <a href="https://www.google.com/maps?authuser=0" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/maps.png">
        </a>
        <a href="https://docs.google.com/spreadsheets/u/0/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/fogli.png">
        </a>
        <a href="https://docs.google.com/document/u/0/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/documenti.png">
        </a>
    </div>

    <div class="colonnasiti terza">
        <a href="https://www.skyscanner.it/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/skyscanner.webp">
        </a>
        <a href="https://www.booking.com/index.it.html" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/booking.jpg">
        </a>
        <a href="https://www.airbnb.it/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/airbnb.png">
        </a>
        <a href="https://www.ryanair.com/it/it/" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/rynair.png">
        </a>
        <a href="https://www.trenitalia.com/it.html" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/trenitalia.png">
        </a>
        <a href="https://www.italotreno.com/it" target="_self" class="tile">
            <img src="https://raw.githubusercontent.com/simonir94/home2/refs/heads/main/italo.png">
        </a>
    </div>

    <div class="news-container">
        <h3 class="news-title-header">⚖️ Aggiornamenti Norme & Fisco</h3>
        <div id="news-feed" class="news-list">
            <p style="text-align:center; color:#888;">Caricamento flussi fiscali...</p>
        </div>
    </div>

    <script>
        const RSS_SOURCES = [
            { name: "Il Sole 24 Ore", url: "https://www.ilsole24ore.com/rss/norme-e-tributi.xml" },
            { name: "FiscoOggi", url: "https://www.fiscooggi.it/rss/notizie" },
            { name: "Info Fiscale", url: "https://www.informazionefiscale.it/spip.php?page=backend" },
            { name: "Ipsoa", url: "https://www.ipsoa.it/RSS-Feeds/Fisco.aspx" }
        ];

        async function fetchNews() {
            const container = document.getElementById('news-feed');
            let allItems = [];

            try {
                // Carichiamo tutte le fonti in parallelo
                const fetchPromises = RSS_SOURCES.map(source => 
                    fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(source.url)}`)
                    .then(res => res.json())
                    .then(data => {
                        if (data.status === 'ok') {
                            // Aggiungiamo il nome della fonte a ogni articolo
                            return data.items.map(item => ({ ...item, sourceName: source.name }));
                        }
                        return [];
                    })
                    .catch(() => []) // Se un feed fallisce, restituiamo un array vuoto
                );

                const results = await Promise.all(fetchPromises);
                allItems = results.flat(); // Uniamo tutti gli articoli in un unico array

                // Ordiniamo per data di pubblicazione (più recenti in alto)
                allItems.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));

                if (allItems.length > 0) {
                    container.innerHTML = ''; // Svuota il caricamento
                    
                    // Mostriamo le prime 10 notizie totali
                    allItems.slice(0, 10).forEach(item => {
                        const pubDate = new Date(item.pubDate);
                        const timeString = pubDate.toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' }) + " " + 
                                         pubDate.getHours() + ":" + String(pubDate.getMinutes()).padStart(2, '0');
                        
                        const link = document.createElement('a');
                        link.href = item.link;
                        link.target = "_blank";
                        link.className = "news-item";
                        link.innerHTML = `
                            <div style="display: flex; flex-direction: column; flex-grow: 1;">
                                <span class="news-source">${item.sourceName}</span>
                                <span class="news-text">${item.title}</span>
                            </div>
                            <span class="news-date">${timeString}</span>
                        `;
                        container.appendChild(link);
                    });
                } else {
                    container.innerHTML = "Nessuna notizia disponibile al momento.";
                }
            } catch (error) {
                console.error("Errore news:", error);
                container.innerHTML = "Impossibile caricare le news.";
            }
        }

        // Carica news all'avvio
        fetchNews();
        // Aggiorna ogni 15 minuti
        setInterval(fetchNews, 900000);
    </script>

</body>
</html>
